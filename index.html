<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Login</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
    body {
        margin: 0;
        font-family: "Poppins", sans-serif;
        background: url("/de.jpg") no-repeat center center/cover;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* Modal Background */
    .modal-bg {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* Clean Modern Card */
    .card {
        width: 360px;
        background: #ffffff;
        padding: 32px;
        border-radius: 16px;
        animation: fadeIn 0.5s ease;
        text-align: center;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .logo {
        width: 90px;
        display: block;
        margin: 0 auto 10px auto;
        border-radius: 8px;
    }

    h2 {
        text-align: center;
        margin-bottom: 20px;
        font-weight: 600;
        color: #222;
    }

    /* Centered Input Group */
    .input-group {
        margin-bottom: 18px;
        width: 100%;
        position: relative;
    }

    input {
        width: 100%;
        padding: 12px 42px 12px 12px;
        border-radius: 10px;
        border: 1px solid #ccc;
        font-size: 15px;
        outline: none;
        transition: 0.2s;
        box-sizing: border-box;
    }

    input:focus {
        border-color: #6d28d9;
    }

    /* Password eye button */
    .toggle-pass {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        font-size: 18px;
        color: #555;
        user-select: none;
    }

    .btn {
        width: 100%;
        padding: 12px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-size: 15px;
        font-weight: 500;
        transition: 0.2s;
    }

    .btn-primary {
        background: #6d28d9;
        color: white;
    }

    .btn-primary:hover {
        background: #5b21b6;
    }

    .google-btn {
        margin-top: 10px;
        background: #fff;
        border: 2px solid #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }

    .links {
        margin-top: 15px;
        font-size: 14px;
    }

    .links a {
        color: #6d28d9;
        text-decoration: none;
        cursor: pointer;
    }

    .links a:hover {
        text-decoration: underline;
    }

    /* LOADING OVERLAY */
    #loadingScreen {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.65);
        display: none;
        justify-content: center;
        align-items: center;
    }

    .loader {
        width: 50px;
        height: 50px;
        border: 5px solid #fff;
        border-top: 5px solid #6d28d9;
        border-radius: 50%;
        animation: spin 0.9s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>
</head>

<body>

<!-- Loading -->
<div id="loadingScreen"><div class="loader"></div></div>

<!-- LOGIN MODAL -->
<div class="modal-bg" id="loginModal">
    <div class="card">
        <img src="/2x2.gif" class="logo">
        <h2>Login</h2>

        <div class="input-group">
            <input type="email" id="loginEmail" placeholder="Email">
        </div>

        <div class="input-group">
            <input type="password" id="loginPassword" placeholder="Password">
            <span class="toggle-pass" onclick="togglePassword('loginPassword', this)">üëÅÔ∏è</span>
        </div>

        <button class="btn btn-primary" onclick="loginUser()">Login</button>

        <button class="btn google-btn" onclick="googleLogin()">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="20">
            Sign in with Google
        </button>

        <div class="links">
            <a onclick="forgotPassword()">Forgot Password?</a><br>
            <a onclick="openSignup()">Create an Account</a>
        </div>
    </div>
</div>

<!-- SIGNUP MODAL -->
<div class="modal-bg" id="signupModal" style="display:none;">
    <div class="card">
        <img src="/2x2.gif" class="logo">
        <h2>Sign Up</h2>

        <div class="input-group">
            <input type="email" id="signupEmail" placeholder="Email">
        </div>

        <div class="input-group">
            <input type="password" id="signupPassword" placeholder="Password">
            <span class="toggle-pass" onclick="togglePassword('signupPassword', this)">üëÅÔ∏è</span>
        </div>

        <button class="btn btn-primary" onclick="signupUser()">Create Account</button>

        <div class="links">
            <a onclick="closeSignup()">Back to Login</a>
        </div>
    </div>
</div>

<!-- Firebase -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
    import {
        getAuth,
        signInWithEmailAndPassword,
        createUserWithEmailAndPassword,
        sendPasswordResetEmail,
        GoogleAuthProvider,
        signInWithPopup
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCriEnMvKH7tkknm-6oqBCYbxV_t0JvUa0",
      authDomain: "data-7a39e.firebaseapp.com",
      projectId: "data-7a39e",
      storageBucket: "data-7a39e.firebasestorage.app",
      messagingSenderId: "674994211689",
      appId: "1:674994211689:web:1c66c2fce67e1fe766cbf8",
      measurementId: "G-D5LNKTPWGD"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);

    function showLoader(){ loadingScreen.style.display="flex"; }
    function hideLoader(){ loadingScreen.style.display="none"; }

    // Toggle show/hide password
    window.togglePassword = function(id, elem){
        const input = document.getElementById(id);
        if(input.type === "password"){
            input.type = "text";
            elem.textContent = "üôà";
        } else {
            input.type = "password";
            elem.textContent = "üëÅÔ∏è";
        }
    };

    // LOGIN
    window.loginUser = function () {
        showLoader();
        signInWithEmailAndPassword(auth, loginEmail.value, loginPassword.value)
            .then(() => {
                hideLoader();
                window.location.href = "/main/index.html";
            })
            .catch(e => { hideLoader(); alert(e.message); });
    };

    // GOOGLE LOGIN
    window.googleLogin = function () {
        showLoader();
        const provider = new GoogleAuthProvider();
        signInWithPopup(auth, provider)
            .then(() => {
                hideLoader();
                window.location.href = "/main/index.html";
            })
            .catch(e => { hideLoader(); alert(e.message); });
    };

    // SIGNUP
    window.signupUser = function () {
        showLoader();
        createUserWithEmailAndPassword(auth, signupEmail.value, signupPassword.value)
            .then(() => {
                hideLoader();
                alert("Account created!");
                closeSignup();
            })
            .catch(e => { hideLoader(); alert(e.message); });
    };

    // FORGOT PASSWORD
    window.forgotPassword = function () {
        const email = prompt("Enter your email:");
        if (!email) return;
        sendPasswordResetEmail(auth, email)
            .then(() => alert("Password reset sent!"))
            .catch(e => alert(e.message));
    };

    // Switch Modals
    window.openSignup = function () {
        loginModal.style.display = "none";
        signupModal.style.display = "flex";
    };
    window.closeSignup = function () {
        signupModal.style.display = "none";
        loginModal.style.display = "flex";
    };
</script>

</body>
</html>
